{% extends "mxv/base.html" %}
{% load static %}

{% block title%}Questions{% endblock %}

{% block breadcrumb %}
    <li class="breadcrumb-item"><a href="{% url 'index' %}">Home</a></li>
    <li class="breadcrumb-item active">Questions</li>
{% endblock %}

{% block content %}
    

<h2>Questions for Candidates</h2>
<!-- IF HAS QUESTION -->

{% if not has_question %}
    <h3>Ask a candidate a question</h3>
    <p class="body-sm-1">You can ask candidates 1 question. There are 6 question topics to choose from. <a href="#">Find out more</a></p>
    <a class="btn btn-outline-primary btn-block" href="#ask-a-question">ASK A QUESTION</a>
{% endif %}

<!-- IF APPROVED OR PENDING QUESTION -->

{% if pending_question %}
<div class="row">
  <div class="col-sm-12">
    <h1>PENDING STATE</h1>
  </div>
</div>
{% endif %}

<!-- ELSE SHOW MOST RECENT REJECT -->

{% if rejects %}
<div class="row">
  <div class="col-sm-12">
    <!-- TODO: SHOW ONLY MOST RECENT -->
    <p>The following questions have been rejected: </p>
    <table>
      <tr>
        <th>Category</th>
        <th>Text</th>
        <th>Reason for rejection</th>
      </tr>
      {% for question in rejects %}
      <tr>
        <td>{{ question.category.title }}</td>
        <td>{{ question.text | truncatechars:80 }}</td>
        <td>{{ question.reject_reason }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>
</div>
{% endif %}

<!-- DISPLAY QUESTIONS -->
</div>
<div class="container-full grey-backing-strict">
  <div class="row justify-content-center">
    <div class="col-sm-12 col-lg-6">
      <h2>Questions asked</h2>
    </div>
    <div class="row">
      {% for question in questions %}
      <div class="col-sm-12 col-md-6">
        <div class="card">
          <div class="card-body">
            <div class="card-row-body">
              <p class="label-2">Posted by {{ question.author.name }} in <br>{{ question.category.title }} at
                {{ question.created_at }} </p>
              <p class="label-4 mb-0">{{ question.text }}</p>
              <hr class="my-2" />
            </div>
            <div class="card-row-body">
              <button href="{% url 'questions:vote' question.pk %}"
                class="btn btn-outline-primary btn-sm {% if question.voted %}active{% endif %}">
                {% if question.voted %}
                <svg class="align-middle" width="16" height="14" viewBox="0 0 16 14" fill="none"
                  xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M 8,1 8.35355,0.646447 8,0.292893 7.64645,0.646447 Z m 6,6 v 0.5 h 1.2071 L 14.3536,6.64645 Z M 10.5,7 V 6.5 H 10 V 7 Z m 0,6 v 0.5 H 11 V 13 Z m -5,0 H 5 v 0.5 h 0.5 z m 0,-6 H 14 L 8,1 5.5,6.5 Z M 2,7 1.64645,6.64645 0.792893,7.5 H 2 Z m 5.64645,-5.64645 5.99995,6 0.7072,-0.7071 L 8.35355,0.646447 Z M 14,6.5 h -3.5 v 1 H 14 Z M 10,7 v 6 h 1 V 7 Z m 0.5,5.5 h -5 v 1 h 5 z m 0,0.5 V 6.5 L 5,7 v 6 z M 8,1 2,6.5 v 1 h 3.5 z m -5.64645,6.35355 6,-6 -0.7071,-0.707103 -6,6.000003 z"
                    fill="#FF0F80" />
                </svg>
                {% else %}
                <svg class="align-middle" width="16" height="14" viewBox="0 0 16 14" fill="none"
                  xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M8 1L8.35355 0.646447L8 0.292893L7.64645 0.646447L8 1ZM14 7V7.5H15.2071L14.3536 6.64645L14 7ZM10.5 7V6.5H10V7H10.5ZM10.5 13V13.5H11V13H10.5ZM5.5 13H5V13.5H5.5V13ZM5.5 7H6V6.5H5.5V7ZM2 7L1.64645 6.64645L0.792893 7.5H2V7ZM7.64645 1.35355L13.6464 7.35355L14.3536 6.64645L8.35355 0.646447L7.64645 1.35355ZM14 6.5H10.5V7.5H14V6.5ZM10 7V13H11V7H10ZM10.5 12.5H5.5V13.5H10.5V12.5ZM6 13V7H5V13H6ZM5.5 6.5H2V7.5H5.5V6.5ZM2.35355 7.35355L8.35355 1.35355L7.64645 0.646447L1.64645 6.64645L2.35355 7.35355Z"
                    fill="#FF0F80" />
                </svg>
                {% endif %}
                {{ question.num_votes }}
              </button>
              <span class="align-top">
                <span class="badge-primary badge-pill body-sm-1">{{ question.num_answers }}</span> <span
                  class="label-1 secondary">answers</span>
              </span>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<!-- select cats -->

<div class="container">
  <h1>Change Primary Interest: currently -- {{ category }}</h1>
  <form action="{% url 'questions:index' %}" method="POST" id="interest-select">
    {% csrf_token %}
    <select id="id_interest" name="interest">
      <option disabled selected> -- select an option -- </option>
      {% for category in Categories %}
      <option value="{ category.number }">{ category.title }</option>
      {% endfor %}
      <option value='alan'>alan</option>
      <option value='bart'>bart</option>
      <option value='carl'>carl</option>
      <option value='dave'>dave</option>
      <option value='eric'>eric</option>
    </select>
    <input type="submit" value="Load Disciplines" />
  </form>
</div>

<!-- IF NOT CANDIDATE + NO Q, DISPLAY ASK Q -->

{% if not is_candidate %}
{% if not has_question %}
<div class="container">
  <div class="row">
    <div id="#ask-a-question" class="col-sm-12">
    <h2>Ask your question</h2>
    <p>Please do not duplicate existing questions. <a href="#">Read more about question rules and see examples</a></p>

    <form method="post" novalidate>
      {% csrf_token %}
      {% include 'mxv/includes/form.html' %}
      <button type="button" class="btn btn-outline-primary" data-toggle="modal" data-target="#exampleModal">
        SUBMIT
      </button>
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-body">
              <h2>Are you ready to submit your question?</h2>
              <p>Once a question has been submitted it cannot be edited and will be reviewed for meeting the question rules by a
              moderator before appearing in the list</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline-secondary btn-block" data-dismiss="modal">Go back</button>
              <button type="submit" class="btn btn-outline-primary btn-block">SUBMIT</button>
    
            </div>
          </div>
        </div>
      </div>

    </form>

{% endif %}
    </div>
  </div>
{% endif %}
  
{% endblock %}